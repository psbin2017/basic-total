# ✨ 아이템 85: 자바 직렬화의 대안을 찾으라

직렬화의 근본적 문제는 공격 범위가 너무 넓고 지속적으로 더 넓어져 방어하기 어렵다.

`readObject` 메소드는 `Serializable` 인터페이스를 구현했다면 클래스패스 안의 거의 모든 타입의 객체를 만들어 낼 수 있는 마법 같은 생성자다. 자신의 코드는 물론 모든 서드파티 라이브러리도 대상이다.

잠재적으로 위험한 동작을 수행하는 메소드를 가젯(gadget)이라고 부르는데 여러 가젯을 함께 사용해 가젯 체인을 구성할 수도 있다. 더욱이 가젯까지 갈 필요도 없이 역직렬화에 시간이 오래 걸리는 짧은 스트림을 역직렬화하는 것 만으로도 서비스 거부 공격에 대상이 된다.

> 가장 쉽게 회피하는 방법은 아무것도 역직렬화하지 않는 것이다.

새로 작성하는 코드에서 자바의 직렬화를 써야 할 이유는 전혀 없다. 이를 지원해주는 다른 메커니즘이 많이 있다.

이 메커니즘의 공통점은 자바 직렬화보다 훨씬 간단하다는 것이다. 이 데이터 표현의 선두주자는 JSON 이다. 서버 사이의 통신용으로는 프로토콜 버퍼가 있다.

레거시에서 마주치는 직렬화를 배제할 수 없는데, 이 경우는 신뢰할 수 없는 데이터라면 절대 역직렬화 하지 말아야 한다.

이를 또 피할 수 없다면 역직렬화 필터링 (`java.io.ObjectInputFilter`) 를 사용하자.

필터링 방식 중 블랙리스트 방식 보다 화이트리스트 방식을 추천한다.
