# ✨ 아이템 84: 프로그램의 동작을 스레드 스케줄러에 기대지 말라

> 정확성이나 성능 스레드 스케줄러에 따라 달라지는 프로그램이라면 다른 플랫폼에 이식하기 어렵다.

가장 좋은 방법은 실행 가능한 스레드의 평균적인 수를 프로세스 수보다 지나치게 많아지지 않도록 하는 것이다. 그래야 스레드 스케줄러가 고민할 거리가 줄어든다.

여기서 실행 가능한 스레드의 수와 전체 스레드 수는 구분해야 한다. 전체 스레드 수는 훨씬 많을 수 있고, 대기 중인 스레드는 실행 가능하지 않다.

> 스레드는 당장 처리해야할 작업이 없다면 실행되서는 안된다.

스레드 풀의 크기를 적절하게 설정하고 작업은 짧게 유지한다. 스레드는 절대 바쁜 대기 상태가 되면 안된다. 바쁜 대기는 스레드 스케줄러의 변덕에 취약하면서 프로세서에게 부담을 준다.

> 특정 스레드가 다른 스레드들과 비교해서 CPU 시간을 충분히 얻지 못해서 간신히 돌아가는 프로그램을 보더라도 `Thread.yield` 써서 문제를 고쳐보려 하지말자. `Thread.yield` 는 테스트할 수단이 없다.

차라리 애플리케이션 구조를 바꾸어 동시에 실행가능한 스레드 수가 적어지도록 조치하자.

스레드 우선순위를 조정하는 방법있지만 위험이 따른다. 품질을 높이는 용도로 드물게 사용할 수 있지만, **간신히 동작하는 프로그램을 고치는 용도로 사용해서는 절대 안된다.**
